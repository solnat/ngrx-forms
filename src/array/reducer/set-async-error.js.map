{"version":3,"file":"set-async-error.js","sourceRoot":"","sources":["set-async-error.ts"],"names":[],"mappings":";;;;;;;;;;AAAA,yCAA6D;AAC7D,qCAAgE;AAChE,mCAAwC;AACxC,+BAAsC;AAEtC,8BACE,KAA6B,EAC7B,MAAyB;IAEzB,EAAE,CAAC,CAAC,MAAM,CAAC,IAAI,KAAK,6BAAmB,CAAC,IAAI,CAAC,CAAC,CAAC;QAC7C,MAAM,CAAC,KAAK,CAAC;IACf,CAAC;IAED,EAAE,CAAC,CAAC,MAAM,CAAC,SAAS,KAAK,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC;QAClC,MAAM,CAAC,mBAAY,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;IACrC,CAAC;IAED,EAAE,CAAC,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC;QACrB,MAAM,CAAC,KAAK,CAAC;IACf,CAAC;IAED,EAAE,CAAC,CAAC,KAAK,CAAC,kBAAkB,CAAC,OAAO,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;QAC9D,MAAM,CAAC,KAAK,CAAC;IACf,CAAC;IAED,IAAM,IAAI,GAAG,GAAG,GAAG,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC;IACvC,IAAI,KAAK,GAAG,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC;IAEjC,EAAE,CAAC,CAAC,iBAAU,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;QACzD,KAAK,GAAG,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;IAC7B,CAAC;IAED,IAAM,MAAM,gBAAQ,KAAK,CAAC,MAAM,eAAG,IAAI,IAAG,KAAK,MAAE,CAAC;IAClD,IAAM,kBAAkB,GAAG,KAAK,CAAC,kBAAkB,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,KAAK,MAAM,CAAC,OAAO,CAAC,IAAI,EAAzB,CAAyB,CAAC,CAAC;IAE3F,MAAM,CAAC,yBAAiB,CAAC,KAAK,CAAC,EAAE,EAAE,KAAK,CAAC,QAAQ,EAAE,KAAK,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,EAAE,KAAK,CAAC,qBAAqB,CAAC,CAAC;;AAC3H,CAAC;AA/BD,oDA+BC","sourcesContent":["import { Actions, SetAsyncErrorAction } from '../../actions';\r\nimport { computeArrayState, FormArrayState } from '../../state';\r\nimport { deepEquals } from '../../util';\r\nimport { childReducer } from './util';\r\n\r\nexport function setAsyncErrorReducer<TValue>(\r\n  state: FormArrayState<TValue>,\r\n  action: Actions<TValue[]>,\r\n): FormArrayState<TValue> {\r\n  if (action.type !== SetAsyncErrorAction.TYPE) {\r\n    return state;\r\n  }\r\n\r\n  if (action.controlId !== state.id) {\r\n    return childReducer(state, action);\r\n  }\r\n\r\n  if (state.isDisabled) {\r\n    return state;\r\n  }\r\n\r\n  if (state.pendingValidations.indexOf(action.payload.name) < 0) {\r\n    return state;\r\n  }\r\n\r\n  const name = '$' + action.payload.name;\r\n  let value = action.payload.value;\r\n\r\n  if (deepEquals(state.errors[name], action.payload.value)) {\r\n    value = state.errors[name];\r\n  }\r\n\r\n  const errors = { ...state.errors, [name]: value };\r\n  const pendingValidations = state.pendingValidations.filter(v => v !== action.payload.name);\r\n\r\n  return computeArrayState(state.id, state.controls, state.value, errors, pendingValidations, state.userDefinedProperties);\r\n}\r\n"]}